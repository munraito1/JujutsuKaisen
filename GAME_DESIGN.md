# Jujutsu Kaisen: Tactical Strategy Game

## Концепт-документ и техническая архитектура

---

## 1. ОБЩИЙ КОНЦЕПТ

Пошаговая стратегия на Java Swing, сочетающая элементы Heroes of Might & Magic и Civilization:

- **Глобальный слой:** управление территориями, строительство зданий, развитие базы
- **Тактический слой:** пошаговые бои на отдельных аренах
- **Прогрессия:** прокачка героев, исследование технологий, захват районов Токио

---

## 2. СИСТЕМА ЮНИТОВ

### 2.1 Именные персонажи (уникальные, по одному экземпляру)

**Маги:**

| Персонаж | Описание |
|----------|----------|
| Yuji Itadori | Рукопашник с Divergent Fist, высокая физическая сила |
| Megumi Fushiguro | Призыватель Ten Shadows (shikigami) |
| Nobara Kugisaki | Straw Doll Technique, средняя дистанция |
| Satoru Gojo | Limitless + Infinite Void (OP персонаж, получается поздно) |
| Maki Zenin | Физический боец без cursed energy, мастер оружия |
| Inumaki Toge | Cursed Speech, поддержка/контроль |
| Panda | Танк с тремя ядрами (Gorilla, Panda, Sister) |

**Проклятия (боссы):**

| Персонаж | Описание |
|----------|----------|
| Mahito | Idle Transfiguration (изменение формы душ) |
| Jogo | Огненные атаки, высокий урон |
| Hanami | Природные атаки, танк |
| Choso | Blood Manipulation |
| Sukuna | Финальный босс, все виды атак |

### 2.2 Отряды статистов (массовые юниты)

**Маги:**

| Отряд | Описание |
|-------|----------|
| Grade 3 Sorcerer Squad | Слабые, дешевые (5 магов в отряде) |
| Grade 2 Sorcerer Squad | Средние (4 мага в отряде) |
| Grade 1 Sorcerer Squad | Сильные, дорогие (3 мага в отряде) |
| Auxiliary Managers | Не бойцы, дают бонусы (разведка, +ресурсы) |
| Student Recruits | Очень слабые, бесплатные стажеры |

**Проклятия (мобы):**

| Отряд | Описание |
|-------|----------|
| Cursed Spirit Swarm | Толпа слабых (HP как у группы) |
| Grade 2 Curse Pack | Средние враги |
| Grade 1 Curse | Сильные мобы |
| Special Grade Manifestation | Редкий опасный моб (не босс) |

### 2.3 Различия в геймплее

**Именные герои:**
- Занимают 1 слот в команде
- Уникальные способности и cursed techniques
- Детальная прокачка (level, техники, домен)
- Можно экипировать cursed tools
- Участвуют в сюжетных событиях
- Permadeath или очень дорогое воскрешение
- Получаются через квесты/события

**Отряды статистов:**
- Занимают 1 слот, но состоят из нескольких бойцов
- HP отряда = суммарное (при уроне умирают отдельные маги)
- Базовые способности без уникальности
- Апгрейдятся через здания
- Дешево восполняются через найм
- Используются для защиты территорий и массовых атак

---

## 3. СИСТЕМА ЗДАНИЙ

### 3.1 Главная база (Tokyo Jujutsu High)

**Военные здания:**

| Здание | Описание |
|--------|----------|
| Dojo | Тренировка персонажей, +exp каждый ход |
| Sparring Arena | Персонажи учат техники друг у друга |
| Cursed Tool Forge | Крафт оружия и артефактов |
| Summoning Circle | Улучшает призыв shikigami (для Megumi-type) |

**Экономические:**

| Здание | Описание |
|--------|----------|
| Administration Office | +% к получаемым ресурсам |
| Recruitment Office | Найм отрядов статистов |
| Talent Scout | Шанс рекрутировать новых героев каждые N ходов |
| Medical Wing | Авто-лечение между ходами |

**Исследования:**

| Здание | Описание |
|--------|----------|
| Archive | Изучение новых cursed techniques (древо технологий) |
| Research Lab | Открытие улучшений для техник |
| Morgue | Изучение убитых проклятий -> контр-стратегии |
| Barrier Station | Новые типы барьеров для миссий |

### 3.2 Здания в районах (захваченные территории)

| Здание | Описание |
|--------|----------|
| Jujutsu Branch Office | Базовое здание для контроля района |
| Barrier Network | Снижает spawn rate проклятий |
| Intelligence Post | Показывает типы врагов в миссиях заранее |
| Safe House | Размещение команд для быстрого реагирования |
| Resource Depot | Увеличивает доход cursed energy с района |

---

## 4. ИГРОВАЯ КАРТА И ТЕРРИТОРИИ

### 4.1 Глобальная карта
- Разделена на районы Токио (Shibuya, Shinjuku, Roppongi, Harajuku, etc.)
- Каждый район состоит из тайлов (hex или square grid)
- Типы тайлов: равнины, здания, cursed zones (высокий spawn rate)

### 4.2 Контроль территорий
- Неконтролируемый район -> нужно зачистить от проклятий
- Захват -> строишь Jujutsu Branch Office
- Контролируемый район -> пассивный доход cursed energy per turn
- Районы могут быть атакованы проклятиями (нужна защита)

### 4.3 Перемещение
- Команды/отряды двигаются по карте как юниты
- Встреча с проклятием -> тактический бой
- Можно объединять несколько юнитов в армию (лимит: 5 слотов)

---

## 5. СИСТЕМА РЕСУРСОВ

### 5.1 Основные ресурсы

**Cursed Energy Points (CE)** — основная валюта
- Добывается: миссии, контроль районов, здания
- Тратится: найм отрядов, строительство, апгрейды

**Grade Points (GP)** — очки престижа
- Добывается: выполнение заданий разных грейдов
- Тратится: повышение ранга героев, найм элитных отрядов

**Cursed Objects** — редкие предметы
- Добывается: боссы, сложные миссии, события
- Тратится: крафт легендарного снаряжения, особые апгрейды

### 5.2 Вторичные ресурсы
- **Research Points** — для изучения технологий
- **Medical Supplies** — для лечения героев
- **Intel** — для разведки миссий

---

## 6. БОЕВАЯ СИСТЕМА

### 6.1 Структура боя
- Поле: сетка 12x12 тайлов
- Инициатива: based on Speed stat каждого юнита
- Фазы хода: Movement -> Action -> End Turn

### 6.2 Действия в бою

| Действие | Описание |
|----------|----------|
| Move | Перемещение (зависит от Movement stat) |
| Basic Attack | Базовая атака |
| Cursed Technique | Использование способности (стоит cursed energy) |
| Domain Expansion | Разворачивание домена (very expensive) |
| Defend | Защита, снижает урон на следующий ход |
| Use Item | Использование предмета |
| Simple Domain | Личный баф/защита от чужого домена |

### 6.3 Механики
- **Black Flash** — критический урон с шансом (при комбо атак)
- **Binding Vow** — временный обмен (баф за дебаф)
- **Domain Clash** — противостояние доменов
- **Cursed Energy Management** — ограниченный ресурс в бою
- **Terrain effects** — бонусы/штрафы от типа тайла

---

## 7. ПРОГРЕССИЯ И РАЗВИТИЕ

### 7.1 Прокачка героев
- **Level (1-50)** — базовые характеристики (HP, attack, defense, speed)
- **Grade (4 -> 3 -> 2 -> 1 -> Special)** — ранг мага, открывает новые возможности
- **Technique Mastery** — улучшение конкретных способностей (cooldown, damage, cost)
- **Domain Refinement** — апгрейд домена (радиус, эффект, прочность)

### 7.2 Древо технологий (Archive)
```
Basic Combat -> Advanced Combat -> Master Combat
Cursed Tool Research -> Legendary Tools
Domain Theory -> Domain Expansion basics -> Sure-Hit upgrades
Barrier Techniques -> Advanced Barriers
Shikigami Studies -> Divine Dogs -> Nue -> Max Elephant -> Mahoraga
```

### 7.3 Прогрессия игры

**Early game (Turn 1-20):**
- Стартовые герои: Yuji, Megumi, Nobara
- Захват первых 2-3 районов
- Базовые здания (Dojo, Recruitment Office)
- Враги: Cursed Spirit Swarms, Grade 3-2 Curses

**Mid game (Turn 21-50):**
- Рекрут новых героев (Maki, Inumaki, Panda)
- Контроль 5-7 районов
- Апгрейд зданий до level 2-3
- Враги: Grade 1 Curses, первые боссы (Mahito, Jogo)

**Late game (Turn 51+):**
- Все герои включая Gojo
- Большая часть карты под контролем
- Максимальные апгрейды
- Враги: Special Grade bosses, Sukuna, массивные вторжения

---

## 8. ТИПЫ МИССИЙ

### 8.1 Основные миссии
- **Curse Extermination** — зачистка района от проклятий
- **District Defense** — защита от атаки проклятий
- **Boss Hunt** — сюжетная битва с именным боссом
- **Rescue Operation** — спасение гражданских (time limit)
- **Artifact Retrieval** — добыть cursed object с территории

### 8.2 Случайные события
- **Cursed Spirit Outbreak** — внезапный спавн проклятий
- **Special Grade Sighting** — редкий сильный враг
- **Civilian in Danger** — быстрая миссия на спасение
- **Curse User Attack** — PvE против вражеских магов
- **Domain Expansion Emergency** — нужно быстро остановить разворачивание домена

---

## 9. ТЕХНИЧЕСКАЯ ЧАСТЬ (ООП АРХИТЕКТУРА)

### 9.1 Базовая иерархия классов

**Боевые юниты:**
```
Combatant (abstract)
+-- Sorcerer (abstract)
|   +-- NamedSorcerer (abstract)
|   |   +-- YujiItadori
|   |   +-- MegumiFushiguro
|   |   +-- NobaraKugisaki
|   |   +-- ...
|   +-- GenericSorcererSquad
|
+-- CursedSpirit (abstract)
    +-- SpecialCurse (abstract)
    |   +-- Mahito
    |   +-- Jogo
    |   +-- ...
    +-- CursedSpiritMob
```

**Здания:**
```
Building (abstract)
+-- ProductionBuilding
+-- TrainingBuilding
+-- MilitaryBuilding
+-- ResearchBuilding
```

**Способности:**
```
CursedTechnique (interface)
+-- DivergentFist
+-- TenShadows
+-- StrawDollTechnique
+-- Domain (interface)
    +-- InfiniteVoid
    +-- SelfEmbodimentOfPerfection
    +-- ...
```

### 9.2 Ключевые ООП концепты

**Наследование:**
- `Combatant -> NamedSorcerer / GenericSquad / SpecialCurse / CursedMob`
- `Building -> ProductionBuilding / TrainingBuilding / MilitaryBuilding`
- Базовые характеристики и методы в родительских классах
- Специфичное поведение в дочерних

**Полиморфизм:**
- `CursedTechnique` interface -> разные реализации для каждой техники
- `Action` interface -> `AttackAction`, `TechniqueAction`, `DefendAction`
- Единый метод `execute()` с разным поведением

**Инкапсуляция:**
- Private поля для внутреннего состояния
- Геттеры/сеттеры для контролируемого доступа
- Protected для доступа в наследниках

**Абстракция:**
- Abstract классы для общих концептов (`Combatant`, `Building`, `SpecialCurse`)
- Interfaces для поведения (`CursedTechnique`, `GameEventListener`)
- Скрытие сложности реализации

**Композиция:**
- `SorcererTeam` содержит `List<JujutsuSorcerer>`
- `District` содержит `List<Building>`
- `GameMap` содержит `Tile[][]` и `List<District>`
- `BattleSystem` содержит `List<Combatant>` и `BattleState`

### 9.3 Design Patterns

| Паттерн | Применение |
|---------|-----------|
| **Singleton** | `GameManager` — единая точка управления игрой; `ResourceManager` — управление ресурсами; `EventSystem` — система событий |
| **Strategy** | `CursedTechnique` — разные стратегии атаки; AI behavior — разные паттерны поведения врагов |
| **Observer** | `GameEventListener` — подписка на игровые события; Building подписывается на события производства; Mission подписывается на события боя |
| **Command** | `Action` interface — инкапсуляция действий в бою; возможность отмены/повтора действий; история ходов для replay |
| **State** | `BattleState` — состояние боя (PLANNING, EXECUTING, ENDED); `MissionState`; `BuildingState` (BUILDING, ACTIVE, UPGRADING) |
| **Factory** | `SorcererFactory` — создание разных типов магов; `CurseFactory` — создание проклятий по грейду; `BuildingFactory` — создание зданий |
| **Composite** | `SorcererTeam` — группа юнитов как единый объект; `District` — композиция зданий и территории |

### 9.4 Основные системы и менеджеры

- **GameManager (Singleton)** — управление игровым циклом, текущий ход, ссылки на все системы
- **ResourceManager** — отслеживание cursed energy, grade points, cursed objects; методы добавления/трат ресурсов
- **BuildingManager** — список всех зданий на карте; строительство/апгрейд/снос; производство ресурсов каждый ход
- **CombatManager** — управление тактическими боями; расчет урона; проверка условий победы/поражения
- **MapManager** — глобальная карта; управление районами; спавн проклятий
- **EventSystem (Observer)** — регистрация слушателей; отправка событий; обработка игровых событий

### 9.5 Структура данных

**Collections:**
- `List<>` — для юнитов, зданий, техник
- `Map<>` — для быстрого поиска (ID -> Object)
- `Queue<>` — для очереди ходов в бою
- `Set<>` — для уникальных элементов (активные эффекты)

**Enums:**
```java
Grade          (GRADE_4, GRADE_3, GRADE_2, GRADE_1, SPECIAL_GRADE)
ResourceType   (CURSED_ENERGY, GRADE_POINTS, CURSED_OBJECTS)
TileType       (PLAINS, BUILDING, CURSED_ZONE, BARRIER)
ActionType     (MOVE, ATTACK, TECHNIQUE, DEFEND, ITEM)
MissionStatus  (AVAILABLE, IN_PROGRESS, COMPLETED, FAILED)
```

---

## 10. GUI СТРУКТУРА (Swing)

### 10.1 Основные окна/панели

**MainMenuFrame:**
- New Game
- Load Game
- Settings
- Exit

**GameFrame (главное окно):**
- `MapPanel` — глобальная карта с районами
- `InfoPanel` — информация о выбранном юните/здании
- `ResourcePanel` — текущие ресурсы
- `TurnPanel` — номер хода, кнопка Next Turn

**BattleFrame (окно боя):**
- `BattleGridPanel` — поле боя с юнитами
- `UnitInfoPanel` — характеристики выбранного юнита
- `ActionPanel` — доступные действия
- `TurnOrderPanel` — очередь ходов

**BuildingFrame:**
- Список доступных зданий
- Информация о постройке
- Кнопки Build/Upgrade

**HeroManagementFrame:**
- Список героев
- Экипировка
- Прокачка навыков
- Назначение в команды

### 10.2 UI компоненты
- Custom `JPanel` для отрисовки карты/боя
- `JTable` для списков юнитов/зданий
- `JTree` для древа технологий
- `JProgressBar` для HP/Energy/строительства
- Custom dialogs для событий и квестов

---

## 11. ГЕЙМПЛЕЙНЫЙ ЦИКЛ

### 11.1 Один игровой ход

1. **Начало хода**
   - Производство ресурсов с районов
   - Производство зданий
   - Случайные события (roll)

2. **Фаза действий игрока**
   - Перемещение юнитов по карте
   - Строительство/апгрейд зданий
   - Найм отрядов
   - Назначение героев на тренировки
   - Выбор исследований

3. **Фаза миссий**
   - При встрече юнита с врагом -> тактический бой
   - Выполнение активных миссий

4. **Конец хода**
   - Спавн новых проклятий
   - Обновление эффектов
   - Проверка условий победы/поражения
   - Сохранение автосейва

### 11.2 Тактический бой (внутри хода)

1. **Инициализация боя**
   - Расстановка юнитов
   - Расчет initiative order

2. **Боевой раунд**
   - Каждый юнит ходит по очереди
   - Move -> Action -> End
   - Обновление эффектов (DoT, buffs)

3. **Проверка условий**
   - Все враги мертвы -> Victory
   - Все союзники мертвы -> Defeat
   - Иначе -> новый раунд

4. **Завершение боя**
   - Расчет наград
   - Опыт героям
   - Loot

---

## 12. УСЛОВИЯ ПОБЕДЫ/ПОРАЖЕНИЯ

**Победа:**
- Побежден Sukuna (финальный босс)
- ИЛИ контроль над 90% территории Токио
- ИЛИ выполнены все сюжетные миссии

**Поражение:**
- Все именные герои мертвы
- ИЛИ Tokyo Jujutsu High уничтожена
- ИЛИ проклятия контролируют 70% территории

---

## 13. ПЛАН РЕАЛИЗАЦИИ (этапы разработки)

| Этап | Название | Задачи | Статус |
|------|----------|--------|--------|
| 1 | Базовые классы | Иерархия `Combatant`, базовые характеристики (HP, attack, defense), класс `SorcererTeam` | DONE |
| 2 | Простой бой | `BattleSystem` с очередью ходов, базовые действия (move, attack), сетка 10x10, 2-3 героя vs 2-3 мобов | DONE |
| 3 | GUI для боя | `BattleFrame` с отрисовкой сетки, клики по юнитам, информация о юните | DONE |
| 4 | Cursed Techniques | Interface `CursedTechnique`, 3-4 техники для стартовых героев, система cursed energy в бою | DONE |
| 5 | Глобальная карта | `WorldMap` с нод-графом районов (`District`), `GameFrame`, перемещение по карте, запуск боёв | DONE |
| 6 | Здания | Иерархия `Building`, 3-4 простых здания, система строительства | |
| 7 | Ресурсы и экономика | `ResourceManager`, производство ресурсов, затраты на действия | |
| 8 | Прогрессия | Система уровней для героев, базовое древо технологий, апгрейды зданий | |
| 9 | События и миссии | `EventSystem`, 2-3 типа миссий, система наград | |
| 10 | Контент и баланс | Все герои, все боссы и мобы, балансировка характеристик | |
| 11 | Полировка GUI | Улучшение визуала, анимации, sound effects (опционально) | |
| 12 | Тестирование | Баг-фиксы, балансировка сложности, оптимизация производительности | |

---

## 14. ТЕХНИЧЕСКИЕ ТРЕБОВАНИЯ

**Язык и инструменты:**
- Java 11+
- Swing для GUI
- Serialization для сохранений
- JUnit для тестов (опционально)

**Структура проекта:**
```
src/
+-- main/
|   +-- models/          # Классы данных (Combatant, Building, etc.)
|   +-- controllers/     # Игровая логика (GameManager, BattleSystem)
|   +-- views/           # GUI компоненты (Frames, Panels)
|   +-- systems/         # Системы (ResourceManager, EventSystem)
|   +-- utils/           # Вспомогательные классы
|   +-- Main.java
+-- resources/
    +-- images/          # Спрайты, иконки
    +-- sounds/          # Звуки (опционально)
    +-- data/            # Конфигурационные файлы
```

**Паттерны кода:**
- Model-View-Controller (MVC) для разделения логики и GUI
- Названия классов: CamelCase
- Константы: UPPER_SNAKE_CASE
- Комментарии на английском
- JavaDoc для публичных методов

---

## 15. ВОЗМОЖНЫЕ РАСШИРЕНИЯ

- Мультиплеер (PvP тактические бои)
- Редактор карт
- Mod поддержка (свои персонажи/техники)
- Сюжетные cutscenes
- Больше персонажей из манги
- Season 2 контент (Culling Game)
- Difficulty levels
- Achievement система
- Leaderboards

---

## ЗАКЛЮЧЕНИЕ

Этот план покрывает:
- Игровую механику (стратегия + тактика)
- Систему юнитов (герои + статисты)
- Здания и территории
- Боевую систему
- ООП архитектуру (наследование, полиморфизм, паттерны)
- GUI структуру
- План разработки

**Главная цель:** изучение ООП через практику создания полноценной игры с правильной архитектурой.

**Следующий шаг:** начать с Этапа 1 (базовые классы) и постепенно наращивать функционал.
